O-Game 브라우저 Vol.2
---------------------
버      전: 1.12 (1.12.0.33)
제  작  자: Thermidor (thermidor@chol.com)
제  작  일: 2007-01-29
최종수정일: 2008-10-17


이 프로그램은 O-Game 모니터링 전용 미니 도구이다.

- 더 이상 멀티탭 웹 브라우저의 기능을 제공하지 않는다.

- 더 이상 SMS 송신 기능을 제공하지 않는다.



[실행 환경]

- Microsoft Windows XP SP2 이상

- Microsoft .NET Framework 2.0이 설치되어 있어야 한다.



[주요 기능]

- 모니터링 메인 창: 자동으로 일정(랜덤) 주기로 현황을 갱신하고, 현재 시각 및 함대 입/출 현황,
그리고 점수와 순위 및 각 식민지 자원 현황을 표시해준다.

- 정탐 감지: 적이 정탐을 보내오고 있는 경우 이를 확인하고 경고 메시지를 출력한다. 창이 최소화되어
있거나 트레이 아이콘으로 있는 경우 자동으로 나타난다.
(메뉴에서 함대/자원 현황을 새로 고치면 경고 메시지가 초기화된다.)

- 공격 감지: 적이 공격해오고 있는 경우 이를 확인하고 경고 메시지(+알람 소리)를 출력하고 SMTP 설정이
되어 있는 경우 메일을 발송한다. 창이 최소화되어 있거나 트레이 아이콘으로 있는 경우 자동으로 나타나며
맨 앞 창(TopMost)으로 표시된다.
(공격 경고 메시지는 3회 연속(자동 갱신 시각 기준) 표시되며, 공격이 종료된 이후 메뉴에서 함대/자원
현황을 새로 고치면 경고 메시지가 초기화된다. 공격이 종료되기 전까지는 계속 표시된다.)

- 로그인 유지/봇 탐지 회피 기능: 최소~최대 갱신 주기를 설정하여 임의의 시간 간격으로
페이지를 갱신하도록 하며, 페이지 로그인 유지(쿠키) 기능을 추가했다.
(보통 15분 정도 설정하는 것이 무난함. 짧게 설정할수록 정탐/공격 감지 기능이 좋아지지만
그만큼 GO의 봇 탐지에 걸려 영구밴 당할 확률이 높아질 수 있음.)

- 야간 모니터링(봇 탐지 회피) 기능: 야간(새벽1시~7시)에는 모니터링 갱신 주기를 4배로 늘려
최대 15분 ~ 60분 사이로 갱신되도록 조정하는 기능을 추가했다. 이 기능으로 야간에는 주간과 달리
공격 감지가 상대적으로 느릴 수 있지만, 실제 사람의 행동 패턴을 적용하여 GO의 봇 탐지에 걸릴
수 있는 가능성을 낮췄다.

- 이벤트 알림 설정 기능: 특정 시각(예: 공격함대 배치 끝)이 되면 메시지로 알려주는 기능이다.
분 단위까지 설정할 수 있으며, 같은 시각에는 하나의 이벤트만 등록이 가능하다.
(메시지와 함께 메인 창도 최소화되어 있거나 트레이 아이콘으로 있는 경우 자동으로 나타난다.)

- 원정 설정 기능: 원정을 출발할 행성, 함대 구성, 탐사시간을 설정하고 원정을 보내는 기능이다.

- 자원 모으기 설정 기능: 자원이 도착할 행성, 자원 운송 형태, 비행 속도, 함대 구성 등을 설정하고
행성에 일정량의 듀테륨을 남기는 옵션도 제공한다.

- 원정 기능: "함대현황" 트리메뉴에서 마우스 오른쪽 버튼을 눌러서 원정을 보낼 수 있다.
원정 설정 기능에서 지정된 행성에서 원정을 출발한다.

- 자원 모으기(운송) 기능: "자원현황" 트리메뉴 하위의 개별 행성 트리 노드에서 마우스 오른쪽 버튼을
눌러서 자원 운송을 보낼 수 있다. 1순위로 지정된 함대로 해당 행성의 모든 자원을 실어 보낼 수 없으면
자동으로 2순위로 지정된 함대까지 보낸다. 출발지와 도착지의 좌표가 같으면 자원 운송을 할 수 없다.

- 은하별 자원 모으기 기능: "자원현황" 트리메뉴 하위의 은하 트리 노드에서 마우스 오른쪽 버튼을
눌러서 해당 은하에 있는 모든 행성에서 자원 운송을 보낼 수 있다. 기타 세부 기능은 위 자원 운송
기능과 동일하며, 출발지와 도착지가 같은 행성이 있더라도 에러를 표시하지 않고 무시한다.

- 플릿 세이빙 기능: "자원현황" 트리메뉴 하위의 개별 행성 트리 노드에서 마우스 오른쪽 버튼을 눌러서
플릿 세이빙을 할 수 있다. 해당 행성의 모든 자원과 함대를 자원 모으기 설정에서 지정된 행성으로
10% 속도로 보낸다. 함대 수가 모자라 자원이 남으면 자원의 가치에 따라 메탈, 크리스탈, 듀테륨의
순서로 남긴다.

- 예약 설정 기능: 원정, 자원 모으기, 플릿 세이빙을 예약할 수 있는 기능이다.
분 단위까지 설정할 수 있으며, 같은 시각에는 하나의 예약 작업만 등록이 가능하다.
자원 모으기는 은하 단위 혹은 전제 은하의 자원을 다 모으는 옵션을 선택할 수 있고, 플릿 세이빙은
특정 행성을 선택할 수 있는 옵션을 제공한다. 원정은 기본 설정에 따른다.



[옵션 설정]

- refreshRate: O-Game 초기 페이지를 갱신할 시간 간격(분).

- refreshRateMax: O-Game 초기 페이지를 갱신할 최대 시간 간격(분). 이 두 시간 간격
사이의 값으로 페이지가 갱신된다.

- summerTimed: 독일 썸머타임 적용 여부(4 ~ 10월).

- useFireFox: 파이어폭스를 연결 웹 브라우저로 사용할 지의 여부.

- FireFoxDir: 파이어폭스가 설치된 경로.

- showInLeftBottom: 창을 화면 하단 오른쪽 모서리에 나타낼 것인지의 여부. 체크를 끄면
화면 하단 왼쪽 모서리에 표시된다.

- smtpmail: 공격 탐지 시 발송할 메일 주소 및 메일 서버 정보.



[기타 옵션]

(oBrowser2.exe.config 환경설정 파일 직접 사용)

- 자동 로그인을 위한 사용자 정보 입력 항목(userid, pwd) 추가

- 이벤트 알림 및 예약 설정 항목(eventSettings) 추가

- 원정 설정 항목(expedition) 추가

- 자원 모으기 설정 항목(resCollecting) 추가

- 공격 메시지 해쉬값 항목(attackHash) 추가



[사용 방법]
   
1. 파일 메뉴의 'O-Game 접속' 메뉴를 통해 O-Game에 로그인하거나 기존 로그인된
세션을 연장해서 볼 수 있다.

- 새 로그인: 새로 로그인하면 모니터링 창이 활성화된다.

- 세션 연장(IE 사용시 권장): 기존에 로그인되어 있는 웹 브라우저에서 마우스 오른쪽
버튼을 클릭하여 페이지 "속성"을 보면 세션ID("...session=e758265319b2" 형식)가 적혀
있음을 알 수 있다. 여기서 "e758265319b2" 부분을 복사한 뒤 O-Game 접속 창의 세션
ID 부분에 붙여넣으면 기존 로그인된 세션을 그대로 유지한 채 모니터링할 수 있다.

2. 트리 메뉴의 함대현황 및 자원현황 하위의 각 은하별 행성에서 마우스 오른쪽 버튼을 눌러
원정 및 자원 운송 또는 플릿 세이빙을 직접 실행할 수 있다.
이를 위해 도구 메뉴에서 '원정 설정' 및 '자원 모으기 설정'을 미리 해야 한다.


[주의 사항]

1. 게임포지 및 오게임에서 공식 허용된 도구가 아니므로 공개적인 사용을 금함.
(특별히 불법 기능을 포함하고 있는 것은 아니지만 유료 사령관 기능 일부가 포함되어 있다고
GO 측에서 판단할 수 있는 소지가 있음. 즉, 영구밴 당할 수 있음.)

2. 이 도구를 사용하다 운영자 측으로부터 예기치 않은 어떠한 제재를 당하더라도 제작자는
책임을 지지 않음(전적으로 사용자의 책임임).

3. 버그나 개선 사항은 메일로 주실 것.


[기능 개선 로그]

- v1.12: 2008-10-17 업데이트
  . 플릿 세이빙 분리 및 설정 화면 추가
  . 기타 자잘한 기능 수정 및 안정화

- v1.11: 2008-10-17 업데이트
  . 공격함대 발견시 옵션 창 동작 버그 개선
  . 이벤트 알림에 "매일" 옵션 추가
  . 예약(원정/자원 운송/플릿) 기능 추가
  . "원정함대 귀환" 이벤트 알림 자동 등록 옵션 추가
  . "자원 운송 완료" 이벤트 알림 자동 등록 옵션 추가
  . 공격 탐지 시 메일 발송 기능 추가
  . 공격 탐지 기능 개선: 메시지 해쉬값을 이용한 SMTP 재발송 차단
  . 보안 개선: 패스워드 암호화
  . 기타 자잘한 기능 개선

- v1.10: 2008-10-13 업데이트
  . 원정 기능 추가
  . 자원 모으기(운송) 기능 추가
  . 은하별 자원 모으기 기능 추가
  . 플릿 세이빙 기능 추가
  . 기타 자잘한 기능 수정 및 안정화

- v1.09: 2008-10-07 업데이트
  . 자원 수집 기능 개선
  . (제한적) 공개용으로 전환 및 블로그에 배포

- v1.08: 2008-09-19 업데이트
  . 9우주 추가
  . SMS 송신 부분 제거(네이트 측의 보안 작업으로 더이상 동작하지 않음)
  . 이벤트 알림 창 시/분 컨트롤 크기 조정
  . 최소화/복원 옵션 조정: 창 크기가 원래대로 복원되지 않던 버그 수정
  . 실행 시 창 위치(왼쪽하단/오른쪽하단) 옵션 추가

- v1.07: 2008-08-22 업데이트
  . 배너 이미지 변경
  . 트레이 아이콘에서도 웹 브라우저 바로 실행 가능하도록 기능 추가

- v1.06: 2008-08-07 업데이트
  . 이벤트 알림 소리 변경
  . 메시지 창 위치 변경: 좌/우측 하단
  . 자원수집 스레드 관련 수정

- v1.05: 2008-06-27 업데이트
  . 이벤트 알림 자동 저장
  . 이전 버전 설정값 자동 읽기
  . 경고(공격 및 이벤트 알림) 시 소리 출력

- v1.04: 2008-06-23 업데이트
  . 이벤트 알림 설정 기능 추가: 설정값은 프로그램 실행 중에만 유효함, 종료 시 설정 시각 모두 날아감
  
- v1.03: 2008-06-10 업데이트
  . 초기 접속 실패 시 메시지 창 출력
  . 오류 발생 시 자동 재 로그인 기능 버그 수정
  . 웹 브라우저로 열기: 파이어폭스 지원 (파이어폭스에서 로그인한 세션은 오게임 브라우저로 전달되지 않음)
    (파이어폭스 Modify Headers v0.6.4 이상 버전의 Add-on 설치 필요)
  . 파이어폭스를 IE처럼 인식(User-Agent)되도록 하는 기능 추가
  
- v1.02: 2008-06-03 업데이트
  . 새 메시지 알림 확인 기본 단추를 "아니오"로 변경(50초 후 자동으로 웹 브라우저가 열리던 현상 수정)
  . 자원현황: 행성 이름 뒤에 좌표 표시
  . 자원현황: 달이 존재할 때 생기던 버그 수정
  . 행성 수를 최대 18개(달 포함)까지 표시되도록 수정
  . 트레이로 최소화될 때 제목에 로그인된 우주 표시
  . 로그인 중 재접속 메뉴 추가
  . 로그인 아이디/패스워드 저장 기능 추가
  
- v1.01: 2008-06-03 업데이트
  . 새 메시지 알림 기능 추가
  . 자동 로그인 기능 버그 수정
  
- v1.0: 2008-05-28 업데이트
  . 모니터링 전용 미니 도구로 새로 제작

- v0.8c: 2008-05-14 업데이트
  . 로그 파일 로그 기록 개선(파일 이어쓰기)
  . 함대 이동(배치 등) 자원 표시되지 않던 문제 수정
  . 스크립트 에러 표시 관련 기능 개선

- v0.8b: 2008-04-03 업데이트
  . 로그 파일 로그 기록
  . 로그인 유지 기능(페이지 요청 시 쿠키 정보 전송)
  . 봇 탐지 회피 기능(페이지 갱신 랜덤 주기) 추가
  . 웹 사이트 변경에 따른 수정: 제8우주까지 확장, 초기 페이지 변경, 자원 추출 내용 수정

- v0.8a: 2007-07-12 업데이트
  . 자동 로그인 정보(userid/pwd) 옵션 추가
  . 주소창이 없는 경우 초기화면(index.php)을 메인화면(overview.php)으로 자동 이동
  . 자동 로그인 정보가 있는 경우 에러 10회 발생시 자동 재로그인 시도

- v0.88: 2007-04-23 업데이트
  . 화면 자석효과(Sticky Window; Docking Window) 추가

- v0.87: 2007-03-26 업데이트
  . 독일 썸머타임 적용 반영

- v0.86: 2007-03-21 업데이트
  . 자동 업데이트(ClickOnce) 적용
  . 공격함대 발견 로직 보완
  . 창 최소화(트레이) 시 윈도우 종료 신호를 받으면 정상 종료

- v0.85: 2007-03-08 업데이트
  . 자원현황 획득 버그 패치
  
- v0.84: 2007-03-08 업데이트
  . 0.76 버전 오픈에 따른 자원 및 메뉴 변경사항 반영

- v0.83: 2007-03-06 업데이트
  . 공격함대 발견 시 메인 모니터링 창에도 경고 메시지 출력
  . 자원 현황 획득 로직 보완(HTTP gzip, deflate 처리 구분)
  
- v0.82: 2007-02-06 업데이트
  . 모니터링 중 페이지 에러가 연속 10회 이상 발생하면 모니터링 중지 및
    경고창 표시.
  . 창 축소모드에서 함대 이동자원 현황을 가지고 오지 못하던 버그 수정.

- v0.81: 2007-02-05 업데이트
  . 모니터링 실행 중 행성 이름 변경, 식민지 파괴 등 변동사항 발생 시
    정상적으로 표시하지 못하던 문제 수정.
  . 트레이 아이콘 모드로 창 최소화 시 모니터링 주기마다 윈도우 포커스를
    빼앗던 문제 수정.
  . 창 축소 모드 실행 시 웹 브라우저 컨트롤 대신 소켓을 이용하여 빠르게
    결과를 처리하도록 수정.

- v0.80: 2007-02-02 업데이트
  . 창을 닫으면 트레이 아이콘으로 표시하도록 함. 트레이 아이콘 메뉴에서
    프로그램을 종료할 수 있도록 변경.
  . 로그인 폼에서 엔터키로 접속되도록 기능 추가.
  . 탭 오른쪽 버튼 클릭 시 현재 보이는 탭이 닫히던 문제 수정.
  . 웹 브라우저 오른쪽 마우스 버튼 동작되도록 수정.
  . 인터넷이 느린 환경을 고려하여 모니터링 자원 수집 시간제한을 5초에서
    15초로 늘이고 자원수집을 자동 주기 업데이트에서 수동 업데이트로 변경.
  . 공격당할 때 출력하는 경고 메시지창을 50초로 고정하던 것을 모니터링
    주기 기준 상대시간(-10초)으로 변경함.

- v0.79a: 2007-02-01 업데이트
  . 다중 모니터 지원 및 원래 창 크기에서는 도킹 효과 제거.

- v0.79: 2007-02-01 업데이트
  . 브라우저가 실행중일 때 탭을 닫으면 에러나던 문제를 수정함.
  . 자원현황이 자동으로 업데이트되지 않던 문제 및 이동함대 자원량 계산이
    비정상이던 문제를 수정함.
  . 갤럭시별 자원합계 현황 추가 및 모니터링 UI 개선(색상 지원).

- v0.78: 2007-01-31 업데이트
  . 식민지가 9개 미만일 때 에러나던 문제를 수정함.

- v0.77: 2007-01-31 업데이트
  . 각 식민지 자원현황 및 함대 이동자원 현황 표시 기능 추가. 자원현황은
    모니터링 주기의 5배 시간 간격으로 갱신된다. 따라서 모니터링 주기가
    1분으로 설정되어 있는 경우에는 자원현황은 5분 단위로 갱신된다.

- v0.76: 2007-01-30 업데이트
  . 옵션을 .config 파일을 직접 수정하고 실행하는 방식에서 프로그램 실행
    후 옵션 창에서 수정하는 방식으로 변경함.
    (수정된 내용은 %USER_HOME%\Local Settings\Application Data\NETS\
    oBrowser.exe_StrongName_...\(버전) 폴더 아래에 user.config로 저장.)

- v0.75:2007-01-29 업데이트
  . 일정 주기로 브라우저를 갱신(Refresh)하던 것을 일정 주기마다 URL
    재탐색으로 변경함.
    (O-Game 접속 상태가 양호하지 않아 자주 실행 실패 페이지로 이동됨.)
